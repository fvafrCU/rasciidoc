--
title: "An Introduction to *rasciidoc*"
author: 
date: 2018-03-07, 22:33:19
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{An Introduction to rasciidoc }
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# What is *rasciidoc*?
Inspired by Karl Broman`s reader on using knitr
with asciidoc
(<http://kbroman.org/knitr_knutshell/pages/asciidoc.html>), this is a
wrapper to and a slight modification of knitr. 

# Knitting 
## A Minimal Example
Suppose, you have a file that reads
``` {r minimal_knitting_file, comment = ""}
file_name <- system.file("files", "minimal", "knit.Rasciidoc", 
                         package = "rasciidoc")
cat(readLines(file_name), sep = "\n")
```
If you run `render` on this file (we use a temporary directory here)
``` {r minimal_knitting_run}
withr::with_dir(tempdir(), {
                    file.copy(file_name, ".")
                    rasciidoc::render(basename(file_name))
})
if (interactive()) browseURL(file.path(tempdir(), 
                                       paste0(sub("\\..*$", "", 
                                                  basename(file_name)), 
                                              ".html")))
```
you will create an HTML file that is identical to [this file](http://htmlpreview.github.io/?https://github.com/fvafrCU/rasciidoc/blob/master/inst/files/minimal/knit.html). 

## A Simple Example
Suppose, you have a file that reads
``` {r simple_knitting_file, comment = ""}
file_name <- system.file("files", "simple", "knit.Rasciidoc", package = "rasciidoc")
cat(readLines(file_name), sep = "\n")
```
This file obviously reads code from files in a directory called "src/", so we need 
this directory, too:

``` {r simple_knitting_run}
withr::with_dir(tempdir(), {
                    file.copy(file_name, ".")
                    file.copy(file.path(dirname(file_name), "src"), ".", 
                              recursive = TRUE)
                    rasciidoc::render(basename(file_name))
})
if (interactive()) browseURL(file.path(tempdir(), 
                                       paste0(sub("\\..*$", "", 
                                                  basename(file_name)), 
                                              ".html")))
```

This will create an HTML that is identical to [this file](http://htmlpreview.github.io/?https://github.com/fvafrCU/rasciidoc/blob/master/inst/files/simple/knit.html).


# Spinnig
You can also use a spinnig file for input:
``` {r simple_spinnig_file, comment = ""}
file_name <- system.file("files", "simple", "spin.R_nolint", package = "rasciidoc")
cat(readLines(file_name), sep = "\n")
```
You run `render` on it:
``` {r simple_spinnig_run}
withr::with_dir(tempdir(), {
                    file.copy(file_name, ".", overwrite = TRUE)
                    file.copy(file.path(dirname(file_name), "src"), ".", 
                              recursive = TRUE)
                    rasciidoc::render(basename(file_name))
})
if (interactive()) browseURL(file.path(tempdir(), 
                                       paste0(basename(file_name), 
                                              ".html")))
```
and you will create an output html that is identical to [this file](http://htmlpreview.github.io/?https://github.com/fvafrCU/rasciidoc/blob/master/inst/files/minimal/knit.html)

# Knitr Hooks

I change the way knitr translates (see [here](https://yihui.name/knitr/objects/)), as it 
renders messages, warnings and errors to
[NOTE|WARNING|ERROR]-blocks in `asciidoc`, which is ... not my choice.
To restore knitr`s behaviour, set hooks or replacement to
NULL.
``` {r hooks}
rasciidoc::render(file.path(tempdir(), basename(file_name)), hooks = NULL)
if (interactive()) browseURL(file.path(tempdir(), 
                                       paste0(basename(file_name), 
                                              ".html")))
``` 
